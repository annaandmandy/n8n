# 📈 AI 股票趨勢分析系統 - 增強版

基於 Streamlit、FinMind API 和 OpenAI 的專業台股技術分析工具，新增 RSI 指標和成交量分析功能。

## ✨ 功能特色

### 核心功能
- 📊 **專業 K 線圖**: 互動式燭台圖表,支援縮放、平移等操作
- 📈 **移動平均線**: 自動計算 MA5、MA10、MA20、MA60 移動平均線
- 🤖 **AI 深度分析**: 使用 OpenAI GPT-4o-mini 模型進行專業技術面分析
- 📋 **歷史數據展示**: 完整的歷史價格數據表格
- 🎯 **台股數據源**: 支援所有台股股票代碼 (2330, 2317, 2454 等)
- 🆓 **免費數據源**: 使用 FinMind API,無需申請額外金鑰

### ⭐ 新增功能（增強版）
- 📉 **RSI 相對強弱指標**: 計算並顯示 14 日 RSI,自動標示超買超賣區域
- 📊 **成交量分析**: 視覺化成交量變化,紅綠柱狀圖對應漲跌
- ⚠️ **智能警告系統**: RSI 超買(>70)或超賣(<30)時自動警告
- 🎨 **多子圖設計**: K線圖、RSI、成交量分層顯示,清晰易讀
- ⚙️ **自訂參數**: 支援自訂 RSI 計算週期（5-30天）
- 🔍 **增強 AI 分析**: AI 分析新增 RSI 動量分析章節

## 🚀 快速開始

### 1. 安裝依賴

```bash
pip install -r requirements.txt
```

### 2. 獲取 OpenAI API 金鑰

1. 前往 [OpenAI Platform](https://platform.openai.com)
2. 登入或註冊帳號
3. 在 API Keys 頁面創建新的 API 金鑰
4. 確保帳戶有足夠的餘額使用 GPT-4o-mini 模型

**注意**: FinMind API 免費版無需申請金鑰,可直接使用

### 3. 運行應用程式

#### 基礎版
```bash
streamlit run stock_analysis_app.py
```

#### 增強版（推薦）
```bash
streamlit run stock_analysis_app_enhanced.py
```

### 4. 使用系統

1. 在左側側邊欄輸入:
   - 股票代碼 (例如: 2330 (台積電)、2317 (鴻海)、2454 (聯發科))
   - OpenAI API Key
   - 選擇日期範圍 (預設為最近 90 天)
   - 調整 RSI 週期 (預設 14 天) ⭐ 新增

2. 點擊「🔍 分析」按鈕

3. 系統將顯示:
   - 互動式 K 線圖和移動平均線
   - RSI 指標圖表（含超買超賣標線） ⭐ 新增
   - 成交量柱狀圖 ⭐ 新增
   - 基本統計資訊 + RSI 狀態 ⭐ 新增
   - AI 生成的專業技術分析報告（含 RSI 分析） ⭐ 新增
   - 最近 10 筆歷史數據表格（含 RSI 欄位） ⭐ 新增

## 📌 常用台股代碼參考

| 代碼 | 公司名稱 | 產業類別 |
|------|---------|---------|
| **2330** | 台積電 | 半導體 |
| **2317** | 鴻海 | 電子製造 |
| **2454** | 聯發科 | 半導體 |
| **2412** | 中華電 | 電信 |
| **2308** | 台達電 | 電子零組件 |
| **2882** | 國泰金 | 金融 |
| **2881** | 富邦金 | 金融 |
| **2303** | 聯電 | 半導體 |
| **2886** | 兆豐金 | 金融 |
| **1301** | 台塑 | 塑化 |

## 📦 技術架構

### 技術堆疊
- **界面框架**: Streamlit
- **數據來源**: FinMind API (台股數據)
- **AI 模型**: OpenAI GPT-4o-mini
- **視覺化**: Plotly Graph Objects with Subplots
- **數據處理**: Pandas, NumPy

### 核心函數

#### 基礎版函數
1. `get_stock_data(symbol)` - 從 FinMind API 獲取股票數據
2. `filter_by_date_range(df, start_date, end_date)` - 日期範圍過濾
3. `get_moving_averages(df)` - 計算 MA5, MA10, MA20, MA60
4. `generate_ai_insights(...)` - 使用 OpenAI 進行技術分析
5. `plot_candlestick_chart(df, symbol)` - 繪製 K 線圖

#### ⭐ 增強版新增函數
6. `calculate_rsi(df, period)` - 計算 RSI 指標
7. `get_rsi_status(rsi_value)` - 判斷 RSI 狀態（超買/超賣/正常）
8. `plot_advanced_chart(df, symbol)` - 繪製多子圖圖表（K線+RSI+成交量）

## 📊 技術指標說明

### 移動平均線 (MA)
- **MA5**: 5 日移動平均線 - 短期趨勢指標
- **MA10**: 10 日移動平均線 - 短期趨勢指標
- **MA20**: 20 日移動平均線 - 中期趨勢指標
- **MA60**: 60 日移動平均線 - 長期趨勢指標

### ⭐ RSI 相對強弱指標 (新增)

#### 計算公式
```
RSI = 100 - (100 / (1 + RS))
其中 RS = 平均漲幅 / 平均跌幅
```

#### 數值判讀
- **RSI > 70**: 超買區域 ⚠️ 紅色警告
  - 歷史數據顯示,此區域可能出現價格回調
  - 買盤力道可能過強,需注意風險

- **RSI < 30**: 超賣區域 ⚠️ 綠色警告
  - 歷史數據顯示,此區域可能出現價格反彈
  - 賣盤力道可能過強,可能接近底部

- **RSI 30-70**: 正常區域 ℹ️
  - 買賣力道相對平衡
  - 市場處於正常交易狀態

- **RSI 穿越 50**: 中線突破
  - 向上穿越 50: 買方力量增強
  - 向下穿越 50: 賣方力量增強

#### 使用注意事項
- RSI 是動量指標,反映價格變動速度
- 超買不代表一定會下跌,超賣不代表一定會上漲
- 需結合其他指標和價格走勢綜合判斷
- 在強勢趨勢中,RSI 可能長期處於超買或超賣區域

## 🎨 圖表功能

### 增強版多子圖設計

#### 第一層：K 線圖 + 移動平均線
- 綠色/紅色燭台顯示漲跌
- 4 條不同顏色的移動平均線
- 支援縮放、平移、懸停查看詳情

#### 第二層：RSI 指標圖 ⭐ 新增
- 藍色線條顯示 RSI 數值
- 紅色虛線標示超買線（70）
- 綠色虛線標示超賣線（30）
- 灰色虛線標示中線（50）
- 超買區域淡紅色背景
- 超賣區域淡綠色背景
- 懸停顯示精確 RSI 值

#### 第三層：成交量圖 ⭐ 新增
- 柱狀圖顯示每日成交量
- 綠色柱：當日上漲
- 紅色柱：當日下跌
- 協助判斷價格變動的可靠性

## 🤖 AI 分析功能

### 分析架構

增強版 AI 分析新增「RSI 動量分析」章節:

1. **趨勢分析** - 整體走勢、支撐阻力、趨勢強度
2. **技術指標分析** - 移動平均線、成交量關聯
3. **RSI 動量分析** ⭐ 新增
   - RSI 當前狀態和歷史走勢
   - 超買超賣區域的歷史表現
   - RSI 與價格的背離現象
   - 動量強度評估
4. **價格行為分析** - 突破點、波動性、轉折點
5. **風險評估** - 風險等級、支撐阻力區間
6. **市場觀察** - 短中期技術面觀察

### AI 輸出特色
- 純客觀歷史數據分析
- 避免投資建議和預測
- 使用專業術語但易懂
- 強調技術分析局限性
- 繁體中文輸出

## ⚠️ 免責聲明

本系統僅供學術研究與教育用途,AI 提供的數據與分析結果僅供參考,**不構成投資建議或財務建議**。

請使用者自行判斷投資決策,並承擔相關風險。本系統作者不對任何投資行為負責,亦不承擔任何損失責任。

歷史表現不代表未來結果。

## 📝 系統需求

- Python 3.8 或更高版本
- 穩定的網路連線
- 有效的 OpenAI API 金鑰
- 至少 2GB RAM（處理圖表運算）

## 🛠️ 故障排除

### API 連線錯誤
- 檢查網路連線是否正常
- FinMind API 免費版無需金鑰,若連線失敗請稍後再試

### 找不到股票代碼
- 確認輸入的是有效的台股股票代碼 (四位數字)
- 常用代碼: 2330 (台積電)、2317 (鴻海)、2454 (聯發科)
- 不支援美股或其他市場股票

### AI 分析失敗
- 確認 OpenAI API 金鑰是否正確
- 檢查 OpenAI 帳戶是否有足夠的餘額
- 確認帳戶可使用 GPT-4o-mini 模型
- 確認網路連線穩定

### 數據範圍問題
- FinMind 提供的數據從 2020 年開始
- 如選擇的日期範圍過早,可能無法獲取數據

### RSI 顯示 N/A
- RSI 需要足夠的歷史數據才能計算（至少 14 天）
- 如果數據量不足,請擴大日期範圍

### 圖表顯示問題
- 如果圖表過於擁擠,可以調整日期範圍
- 建議日期範圍在 30-180 天之間以獲得最佳視覺效果
- 使用瀏覽器的縮放功能調整圖表大小

## 📚 版本差異

| 功能 | 基礎版 | 增強版 |
|------|--------|--------|
| K 線圖 + MA | ✅ | ✅ |
| RSI 指標 | ❌ | ✅ |
| 成交量圖表 | ❌ | ✅ |
| 多子圖設計 | ❌ | ✅ |
| RSI 警告 | ❌ | ✅ |
| 自訂 RSI 參數 | ❌ | ✅ |
| RSI AI 分析 | ❌ | ✅ |
| 檔案名稱 | stock_analysis_app.py | stock_analysis_app_enhanced.py |

## 🔄 更新日誌

### v2.0 (增強版) - 2025-12-02
- ⭐ 新增 RSI 相對強弱指標
- ⭐ 新增成交量柱狀圖
- ⭐ 新增多子圖視覺化設計
- ⭐ 新增 RSI 超買超賣警告系統
- ⭐ 新增自訂 RSI 參數功能
- ⭐ 增強 AI 分析,新增 RSI 動量分析章節
- 📊 改進圖表佈局,提升可讀性

### v1.0 (基礎版) - 2025-12-02
- 初始版本發布
- 基本 K 線圖和移動平均線
- AI 技術分析
- FinMind API 整合

## 📄 授權

本專案僅供教育和研究用途。

## 🙏 致謝

- **FinMind**: 提供免費的台股歷史數據 API
- **OpenAI**: 提供強大的 AI 分析能力
- **Plotly**: 提供優秀的互動式圖表庫
- **Streamlit**: 提供簡潔易用的網頁框架
